---
/**
 * @file Footer.astro
 * @description Global Footer component.
 * Dynamically renders navigation columns based on Storyblok Global Settings.
 * Supports flexible column layouts via the 'footer_columns' block list.
 *
 * @module components/ui/Footer
 * @version 1.1.0
 * * @imports
 * - GlobalSettings, FooterColumn, NavigationItem: For type-safe content injection.
 * - resolveLink: ISO-compliant, type-safe utility for URL resolution.
 */
import type { GlobalSettings, FooterColumn, NavigationItem } from "@/types/storyblok";
import { resolveLink } from "@/types/storyblok"; 

interface Props {
  settings?: GlobalSettings | null;
}

const { settings } = Astro.props;
const year = new Date().getFullYear();

// Default Data (Fallback when CMS content is missing)
const defaultColumns: FooterColumn[] = [
  {
    _uid: "def-1",
    title: "Quick Links",
    links: [
      { _uid: "l1", name: "Services", link: { cached_url: "services" } } as NavigationItem,
      { _uid: "l2", name: "About", link: { cached_url: "about" } } as NavigationItem,
      { _uid: "l3", name: "Blog", link: { cached_url: "blog" } } as NavigationItem
    ],
    component: "footer_column"
  },
  {
   _uid: "def-2",
    title: "Resources",
    links: [
      { _uid: "l4", name: "Documentation", link: { url: "#" } } as NavigationItem,
      { _uid: "l5", name: "Community", link: { url: "#" } } as NavigationItem,
      { _uid: "l6", name: "GitHub", link: { url: "#" } } as NavigationItem
    ],
    component: "footer_column"
  }
];

// Logic: Use settings if available and populated, otherwise use defaults
const footerColumns = settings?.footer_columns?.length 
  ? settings.footer_columns 
  : defaultColumns;

---

<footer class="border-t border-border bg-card py-12 md:py-16 mt-auto">
  <div class="mx-auto w-full max-w-7xl px-4 bp1020:px-6">
    <div class="grid gap-10 md:gap-12 lg:grid-cols-4 mb-12">
      <div class="lg:col-span-2 space-y-4">
        <div class="flex items-center gap-2">
          <h3 class="font-bold text-xl text-foreground">
            {settings?.site_title || "Astro Template"}
          </h3>
        </div>
        <p class="text-sm leading-relaxed max-w-md text-muted-foreground">
          {settings?.site_description || "A modern, fast, and accessible web template built with Astro 5 and Storyblok. Optimized for performance and SEO."}
        </p>
      </div>
      
      {footerColumns.map((col) => (
        <div>
          <h4 class="font-semibold text-sm mb-4 text-foreground uppercase tracking-wider">
            {col.title}
          </h4>
          <ul class="space-y-3">
            {col.links && col.links.map((item) => (
              <li>
                <a 
                  href={resolveLink(item.link)}
                  class="text-sm text-muted-foreground hover:text-primary transition-colors block"
                >
                  {item.name}
                </a>
              </li>
            ))}
          </ul>
        </div>
      ))}
    </div>
    
    <div class="border-t border-border/50 pt-8 mt-8">
      <div class="flex flex-col md:flex-row items-center justify-between gap-4">
        <p class="text-sm text-muted-foreground text-center md:text-left">
          {settings?.copyright_text || `Â© ${year} ${settings?.site_title || "Astro Template"}. All rights reserved.`}
        </p>
        
        <div class="flex gap-4">
          </div>
      </div>
    </div>
  </div>
</footer>